#from urllib import quote
#from Plugins.Extensions.OpenWebif.local import tstrings
#if len($events) == 0
<img src="images/not_found.png" title="No items found" border="0">
#else
<style>

.tb { display:inline-block; margin-left:3px;}
.bb {width: 38px; height: 38px; margin-top:10px;}
#cl { font-size:32px;margin-top:7px; }
#pp { font-size:12px; float:right; margin-top:-39px; }
#tp {font-family: Arial;font-weight:bold; font-size:12px; float:right; margin-top:-38px; }
#tp2 {font-weight:bold; font-size:20px; float:right; margin-top:-44px; }
#station { cursor:pointer;}
.im { font-family:Impact,Arial;font-size:18px;text-decoration:none;}
table { font-size:12px; font-family: Verdana,Arial,sans-serif;}
.deltimer{display:none;}

.ETV table {font-size:12px;width:100%;}
.ETV table td { width:50px;height:40px;}
.eft td { height:60px;}
.efi { width:100px;}
.eft td > div { display:table;width:100%;}
.esl1,.esl2 { display:table-cell;width:30%;font-size:13px;font-weight: bold;vertical-align: middle;height: 60px;padding-left: 10px;}
.esl2 { width:70%;border-left: 1px solid black;}
.eff {width:100% !important;vertical-align: top;padding-left:10px;}
.efi img {width:100px;height:60px; border:none;}
.eff1 {width:100%;}
.panel.ui-state-hover { background-image: none; }
</style>
<div class="ETV">
<table class="ui-widget ui-widget-content" border="0" cellspacing="1" cellpadding="5">
#for $event in $events
		#set $channel = $event.sname.replace("'", r"\'")
		#set $title = $event.title.replace("'", r"\'")
		#set $sref=quote($event.sref, safe=' ~@#$&()*!+=:;,.?/\'')

	<tbody data-id='$sref;$event.begin_timestamp;$event.duration'>
	<tr class="eft">
	<td class="efi ui-widget-header" colspan="2"><img src="$event.picon" title=""></td>
	<td style="width:100%;height:60px;">
		<div>
		<div class="esl1 panel ui-state-hover">$event.sname<br />$event.date</div>
		<div class="esl2 panel ui-state-hover">$event.title<br/>$event.begin&nbsp;-&nbsp;$event.end&nbsp;($event.duration min.)</div>
		</div>
	</td>
	</tr>
	<tr>
		<td class="timerpanel panel ui-state-hover">
			<a class="tb addtimer" href="#" onclick="addTimerEvent('$sref',$event.id);return false;" title="$tstrings['add_timer']">
			<span class="bb">
			<i id="cl" class="fa fa-clock-o"></i><i id="tp2" class="fa b">+</i>
			</span>
			</a>
			<a class="tb deltimer" href="#" onclick="delTimerEvent(this);return false;" title="$tstrings['delete_timer']">
				<span class="bb">
			<i id="cl" class="fa fa-clock-o"></i><i id="pp" class="fa fa-trash"></i>
			</span>
			</a>
		</td>
		<td class="panel ui-state-hover">
			<a class="tb" href="#" onclick="addEditTimerEvent('$sref',$event.id);return false;" title="$tstrings['edit_timer']">
			<span class="bb">
			<i id="cl" class="fa fa-clock-o"></i><i id="pp" class="fa fa-edit"></i>
			</span>
			</a>
		</td>
		<td class="eff" rowspan="4"><div class="eff1">
			<span>$event.shortdesc</span><br><br></div>
			$event.longdesc
		</td>
	</tr>
	<tr>
		<td class="panel ui-state-hover">
			<a class="tb" href="#" onclick="addTimerEventPlay('$sref',$event.id);return false;" title="$tstrings['add_zaptimer']">
			<span class="bb">
			<i id="cl" class="fa fa-clock-o"></i><i id="pp" class="fa fa-play"></i>
			</span>
			</a>
		</td>
		<td class="panel ui-state-hover">
			#if $at
				<a class="tb" href="#" onclick="addAutoTimerEvent('$sref','$channel','$title','$event.begin','$event.end');return false;" title="$tstrings['add_autotimer']">
				<span class="bb">
				<i id="cl" class="fa fa-clock-o"></i><i id="tp" class="fa">AT</i>
				</span>
				</a>
			#end if
		</td>
	</tr>
	<tr>
		<td class="panel ui-state-hover">
			#if $kinopoisk
			<a class="tb" target="_blank" href="http://www.kinopoisk.ru/index.php?first=no&kp_query=$quote($event.title)"><img src="../images/kinopoisk.png" style="width:24px; height:24px; margin:0px 3px 0px 0px" title="$tstrings['search_kinopoisk']" border="0"></a>
			#else
			<a class="im tb" target="_blank" href="http://www.imdb.com/find?s=all&amp;q=$quote($event.title)" title="$tstrings['search_imdb']">IMDb</a>
			#end if
		</td>
		<td></td>
	</tr>
</tbody>
#end for
</table>
</div>
<script type="text/javascript">
var t = [
#for $timer in $timers
	{'begin':$timer.begin,'end':$timer.end,'sref':'$timer.serviceref'},
#end for
];
#raw
var reloadTimers = true;
$(function() {
	$('#editTimerForm').load('ajax/edittimer');
	if (t.length > 0) {
		// FIXME 
		$( "tbody" ).first(function() {
			if($( this ).data('id')) {
				ShowTimers(t);
			}
		});
	}
});
#end raw
</script>
#end if
