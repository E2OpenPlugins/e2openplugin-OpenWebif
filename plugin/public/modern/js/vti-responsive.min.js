var vol_slider=document.getElementById("volslider"),cur_vol=-1,standby_status=-1,timerFormInitiated=-1;function getNoUISliderValue(t,e){t.noUiSlider.on("update",function(){var e=t.noUiSlider.get(),e=parseInt(e);$("#volumevalue").find("span.curvolume").text(e+"%"),-1!=cur_vol&&$.ajax("web/vol?set=set"+e),cur_vol=e})}function initJsTranslationAddon(e){tstr_timer=e.timer,tstr_loading=e.loading,tstr_add_timer=e.add_timer,tstr_cancel=e.cancel,tstr_close=e.close,tstr_rename=e.rename,tstr_prompt_save_changes=e.prompt_save_changes,tstr_oops=e.oops,tstr_weekday=e.at_filter_weekday,tstr_weekend=e.at_filter_weekend,tstr_at_del=e.at_del,tstr_at_filter_title=e.at_filter_title,tstr_at_filter_short_desc=e.at_filter_short_desc,tstr_at_filter_desc=e.at_filter_desc,tstr_at_filter_day=e.at_filter_day,tstr_at_filter_include=e.at_filter_include,tstr_at_filter_exclude=e.at_filter_exclude,tstrings_no_cancel=e.no_cancel,tstrings_yes_delete=e.yes_delete,tstrings_yes=e.yes,tstrings_deleted=e.deleted,tstrings_cancelled=e.cancelled,tstrings_need_input=e.need_input,tstrings_install_package=e.install_package,tstrings_remove_package=e.remove_package,tstrings_update_package=e.update_package,tstrings_upload_package=e.upload_package,tstrings_upload_error=e.upload_error,tstr_bqe_add_url=e.bqe_add_url,tstr_bqe_name_url=e.bqe_name_url}function toggleFullRemote(){$("#symbolRemoteView").toggle(),$("#fullRemoteView").toggle()}function SetSpinner(){loadspinner=" \t<div class='page-loader-wrapper'> \t\t<div class='loader'> \t\t\t<div class='preloader'> \t\t\t\t<div class='spinner-layer pl--skinned'> \t\t\t\t\t<div class='circle-clipper left'> \t\t\t\t\t\t<div class='circle'></div> \t\t\t\t\t</div> \t\t\t\t\t<div class='circle-clipper right'> \t\t\t\t\t\t<div class='circle'></div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t</div> \t\t\t<p>"+tstr_loading+"...</p> \t\t</div> \t</div>"}function listTimers(){$("#timerdlgcont").html(loadspinner).load("ajax/timers #timers")}function set_epg_modal_content(e){$("#editTimerForm").load("ajax/edittimer"),$("#epgmodalcontent").html($(e).find("#epgcards").html())}function open_epg_dialog(e,t){$("#epgmodalcontent").html(loadspinner);e="ajax/epgdialog?sref="+encodeURIComponent(e);$.get(e,set_epg_modal_content)}function load_channelsepg(e){return $("#channel_epg_container").load(e),!1}function load_subcontent(e){return $("[id^=sub_content_container]").load(e),!1}function loadtvcontent(e){return $("[id^=tvcontent]").load(e),!1}function load_maincontent(e){return(lastcontenturl!=e||-1<e.indexOf("screenshot")||-1<e.indexOf("boxinfo"))&&($("#content_container").load(e),lastcontenturl=e),!1}function load_maincontent_spin_force(e){var t='<div id="content_main">'+loadspinner+"</div>";return $("#content_container").html(t).load(e),lastcontenturl=e,!1}function testPipStatus(){$.ajax({url:"api/pipinfo",dataType:"json",cache:!1,success:function(e){e.pip!=pip&&(pip=e.pip,buttonsSwitcher(e.pip))}})}$(function(){noUiSlider.create(vol_slider,{start:[30],connect:"lower",step:5,range:{min:[0],max:[100]}}),getNoUISliderValue(vol_slider,!0),timeredit_initialized||$("#editTimerForm").load("ajax/edittimer"),$("#navbar-collapse").on("show.bs.modal",function(e){$("#navbar-collapse").removeAttr("style")}),$("#navbar-collapse").on("hide.bs.modal",function(e){$("#navbar-collapse").addAttr("style","width:100%")}),$("#TimerModal").on("show.bs.modal",function(e){if(!$("#TimerModal").data("bs.modal").isShown){1!==timerFormInitiated&&initTimerEditForm();try{var t="metadata",a=e.relatedTarget.closest("[data-"+t+"]"),i={};null!=a?i=JSON.parse(e.relatedTarget.closest("[data-"+t+"]").dataset[t]):(i.sref=e.relatedTarget.dataset.ref,i.id=e.relatedTarget.dataset.evid)}catch(e){console.log(e),i={}}i.sref&&i.id?addEditTimerEvent(i.sref,i.id):i.sref&&i.begin&&i.end?editTimer(i.sref,i.begin,i.end):addTimer()}}),$("#TimerModal").on("hidden.bs.modal",function(e){}),autosize($("textarea.auto-growth")),$.VTiTools.epgsearch.activate(),$.VTiTools.moviesearch.activate(),$(document).keydown(function(e){(e.ctrlKey||e.cmdKey)&&70===e.keyCode&&(e.preventDefault(),$.VTiTools.epgsearch.showSearchBar()),(e.ctrlKey||e.cmdKey)&&69===e.keyCode&&(e.preventDefault(),$.VTiTools.epgsearch.showSearchBar()),(e.ctrlKey||e.cmdKey)&&77===e.keyCode&&(e.preventDefault(),$.VTiTools.moviesearch.showSearchBarMovie())}),VTiWebConfig(),setInterval(function(){getStatusInfo()},3e3)});var SSHelperObj=function(){var t;return{setup:function(){t=this,clearInterval(t.screenshotInterval),t.ssr_i=parseInt(GetLSValue("ssr_i","30")),$("#dropdown").click(function(){testPipStatus()}),$("#screenshotbutton0").click(function(){testPipStatus(),grabScreenshot("all")}),$("#screenshotbutton1").click(function(){testPipStatus(),grabScreenshot("video")}),$("#screenshotbutton2").click(function(){testPipStatus(),grabScreenshot("osd")}),$("#screenshotbutton3").click(function(){testPipStatus(),grabScreenshot("pip")}),$("#screenshotbutton4").click(function(){testPipStatus(),grabScreenshot("lcd")}),$("button").click(function(){testPipStatus()}),$("#ssr_i").val(t.ssr_i),$("#ssr_s").prop("checked",GetLSValue("ssr_s",!1)),$("#ssr_hd").prop("checked",GetLSValue("ssr_hd",!1)),$("#screenshotspinner").addClass(GetLSValue("spinner","fa-spinner")),$("#ssr_hd").change(function(){testPipStatus(),SetLSValue("ssr_hd",$("#ssr_hd").is(":checked")),grabScreenshot("auto")}),$("#ssr_i").change(function(){testPipStatus();var e=$("#ssr_i").val();SetLSValue("ssr_i",e),t.ssr_i=parseInt(e),$("#ssr_s").is(":checked")&&(clearInterval(t.screenshotInterval),t.setSInterval())}),$("#ssr_s").change(function(){testPipStatus();var e=$("#ssr_s").is(":checked");e?t.setSInterval():clearInterval(t.screenshotInterval),SetLSValue("ssr_s",e)}),screenshotMode="all",grabScreenshot(screenshotMode),GetLSValue("ssr_s",!1)&&t.setSInterval()},setSInterval:function(){t.screenshotInterval=setInterval(function(){testPipStatus(),grabScreenshot("auto")},1e3*(t.ssr_i+1))}}},SSHelper=new SSHelperObj;function load_reboot_dialog(e,t){t=loadspinner.replace("<p>"+tstr_loading+"...</p>","<p>"+tstr_loading+"...</p><p>"+t+"</p>");$("#responsivespinner").html(t)}function toggleLeftSideBar(){var e=$("body"),t=e.height(),a=$("#fullmaincontent");$("body").hasClass("ls-closed-manual")?(a.addClass("content"),a.removeClass("contentfull"),e.removeClass("ls-closed-manual"),$("#epgcard").height($("#leftsidemenu").height()-30+"px"),$("#topmenuheader,#mainfooter").show(),$("#togglefullscreen").html("fullscreen")):(e.addClass("ls-closed-manual"),a.removeClass("content"),a.addClass("contentfull"),$("#epgcard").height(t+"px"),$("#topmenuheader,#mainfooter").hide(),$("#togglefullscreen").html("fullscreen_exit")),setTimeout(function(){load_tvcontent("ajax/multiepg?epgmode=tv")},500)}function grabScreenshot(e){$("#screenshotimage").load(function(){$("#responsivespinnerscreenshot").hide()}),"auto"!=e?screenshotMode=e:e=screenshotMode,timestamp=(new Date).getTime(),$("#ssr_hd").is(":checked")?$("#screenshotimage").attr("src","/grab?format=jpg&mode="+e+"&t="+timestamp):$("#screenshotimage").attr("src","/grab?format=jpg&r=720&mode="+e+"&t="+timestamp),$("#screenshotimage").attr("style","max-height:60vh;"),"lcd"==e?$("#screenshotimage").attr("class","img-responsive center-block"):$("#screenshotimage").attr("class","img-responsive img-rounded center-block")}function setOSD(e){var t=current_ref=e.currservice_serviceref,a=current_name=e.currservice_station,i=tstr_stream+": "+a+"'><i class='material-icons'>ondemand_video</i></a>",n=tstr_stream+" ("+tstr_transcoded+"): "+a+"'><i class='material-icons'>phone_android</i></a>",r=e.currservice_begin+" - "+e.currservice_end,s="",o="",c="",l="";a&&(-1!==t.indexOf("1:0:1")||-1!==t.indexOf("1:134:1")||-1!==t.indexOf("1:0:2")||-1!==t.indexOf("1:134:2")?(!e.transcoding||-1===t.indexOf("1:0:1")&&-1===t.indexOf("1:134:1")||(s="<a href='#' onclick=\"jumper8002('"+t+"', '"+a+"')\"; title='"+n),c=-1!==t.indexOf("1:0:2")||-1!==t.indexOf("1:134:2")?(i=tstr_stream+": "+a+"'><i class='material-icons'>radio</i></a>","<a href='/#radio' onclick='load_maincontent(\"ajax/radio\");'><b>"+a+"&nbsp;&nbsp;</b>"+r+"</a>"):(i=tstr_stream+": "+a+"'><i class='material-icons'>ondemand_video</i></a>","<a href='/#tv' onclick='load_maincontent(\"ajax/tv\");'><b>"+a+"&nbsp;&nbsp;</b>"+r+"</a>"),o="<a href='/web/stream.m3u?ref="+t+"&name="+a+"' target='_blank' title='"+i,l='<a href="#" onclick="open_epg_dialog(\''+t+"', '"+a+'\')" data-toggle="modal" data-target="#EPGModal" title=\''+e.currservice_fulldescription+"'><b>"+e.currservice_name+"</b></a>"):-1===t.indexOf("4097:0:0")&&-1===t.indexOf("1:0:0")||(""===e.currservice_filename?o="<a href='#' title='"+(i=tstr_stream+": "+a+"'>"+a+"</a>"):(i=tstr_stream+": "+a+"'><i class='material-icons'>movie</i></a>",o="<a href='/web/ts.m3u?file="+e.currservice_filename+"' target='_blank' title='"+i,c="<a href='/#movies' onclick='load_maincontent(\"ajax/movies\");'><b>"+a+"&nbsp;&nbsp;</b></a>",e.transcoding&&(s="<a href='#' onclick=\"jumper8003('"+e.currservice_filename+"')\"; title='"+n)))),$("#responsive_osd_transcoding").html(s),$("#responsive_osd_stream").html(o),$("#responsive_osd_current").html(c),$("#responsive_osd_cur_event").html(l);try{$(".channel-list__channel").removeClass("channel--active"),$("#sref-"+t.replace(/:/g,"_")).addClass("channel--active")}catch(e){}}function loadeventepg(e,t,a){channelpicon=void 0!==a?a:null;t="ajax/event?idev="+e+"&sref="+encodeURIComponent(t);$("#eventdescriptionII").load(t)}function loadtimeredit(e,t){t="ajax/event?idev="+e+"&sref="+encodeURIComponent(t);$("#eventdescriptionII").load(t)}function initTimerEdit(e,i){initTimerBQ(e,function(){for(var e in $("#dirname").find("option").remove().end(),$("#dirname").append($("<option></option>").attr("value","None").text("Default")),_locations){var t=_locations[e];$("#dirname").append($("<option></option>").attr("value",t).text(t))}for(var e in $("#dirname").selectpicker("refresh"),$("#tagsnew").html(""),_tags){var a=_tags[e];$("#tagsnew").append("<input type='checkbox' name='"+a+"' value='"+a+"' id='tag_"+a+"'/><label for='tag_"+a+"'>"+a+"</label>")}$("#tagsnew > input").checkboxradio({icon:!1}),timeredit_initialized=!0,i()})}function initTimerEditBegin(){$("#timerbegin").datetimepicker({format:"dd.mm.yy hh:ii",autoclose:!0,todayHighlight:!0,todayBtn:"linked",minuteStep:2,language:"de"}),$("#timerbegin").datetimepicker().on("changeDate",function(e,t){""!=$("#timerend").val()&&$(this).datetimepicker("getDate")>$("#timerend").datetimepicker("getDate")&&showErrorMain(tstr_start_after_end)})}function TimerConflict(e,t,a,i){var n="";e.sort(function(e,t){return e.begin-t.begin}),e.forEach(function(e){n+="<div class='row clearfix conflicting-timer'><div class='col-xs-12'> \t\t\t<div class='card'> \t\t\t\t<div class='header' style='padding: 10px 20px;'> \t\t\t\t\t<div class='row clearfix'> \t\t\t\t\t\t<div class='col-xs-12'>               <h2>                 <span role='button'>                   <a href='javascript:void(0);' onclick='toggleTimerStatus(\""+e.serviceref+'", "'+e.begin+'", "'+e.end+'"); this.closest(".conflicting-timer").classList.add("fade");\' class="link--skinned" title=\'Disable Timer\'>                     <i class=\'material-icons material-icons-centered material-icons-mg-right\'>alarm_off</i>                   </a>                 </span> \t\t\t\t\t\t\t  '+e.name+"                 <span style='opacity: 0.4;'> - "+e.servicename+"</span>               </h2> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t\t<div class='body'> \t\t\t\t\t\t<div class='row clearfix'> \t\t\t\t\t\t\t<div class='col-xs-12' style='margin: 10px 0 0;'>                 <p>"+e.realbegin+" - "+e.realend+"</p>               </div> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t</div> \t\t</div></div> \t\t"}),$(".modal").modal("hide"),$("#timerconflictmodal").html(n),$("#TimerConflictModal").modal("show")}function cbAddTimerEvent(e){e.state&&($(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] .timer').remove(),$(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] div:first').append('<div class="timer">'+tstr_timer+"</div>"),showErrorMain(tstr_timer_added,!0))}function addTimerEvent(i,n,r,s){var e="/api/timeraddbyeventid?sRef="+i+"&eventid="+n;r&&(e+="&eit=0&disabled=0&justplay=1&afterevent=3"),webapi_execute_result(e,function(e,t,a){!e&&a?TimerConflict(a,i,n,r):void 0!==s?s({sRef:i,eventId:n,justplay:r,state:e,txt:t}):showErrorMain(e?tstr_timer_added:t,!0)})}function addTimer(e,a,i,t){current_serviceref="",current_begin=-1,current_end=-1,servicename="";var n=-1,r=-1,s="",o="",c="",l=0,d=0;void 0!==e&&""!=e&&(n=e.begin,r=e.begin+e.duration,s=e.sref,servicename=e.channel,o=e.title,c=e.shortdesc,l=e.recording_margin_before,d=e.recording_margin_after);var m=$("#bouquet_select > optgroup").length,u=!1;void 0!==a&&(u="1:0:2:"==a.substring(0,6)),$("#cbtv").prop("checked",!u),$("#cbradio").prop("checked",u);e=function(){void 0!==a&&void 0!==i&&(s=a,o=i,"undefined"===$("#bouquet_select").val(a)&&$("#bouquet_select").append($("<option></option>").attr("value",s).text(i))),$("#timername").val(o),$("#description").val(c),$("#dirname").val("None"),$("#enabled").prop("checked",!0),$("#allow_duplicate").prop("checked",!0),$("#autoadjust").prop("checked",!1),$("#justplay").prop("checked",!1),$("#afterevent").val(3);for(var e=0;e<7;e++)$("#day"+e).prop("checked",!1);$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");var t=-1!==n?new Date(1e3*(Math.round(n)-60*l)):new Date;$("#timerbegin").datetimepicker("setDate",t);t=-1!==r?new Date(1e3*(Math.round(r)+60*d)):new Date(t.getTime()+36e5);$("#timerend").datetimepicker("setDate",t),$("#bouquet_select").val(s),$("#bouquet_select").trigger("chosen:updated"),setTimerEditFormTitle(tstr_add_timer)};!timeredit_initialized||m<2?initTimerEdit(u,e):(m=$("#bouquet_select option:last").val(),(!u||"1:0:2:"===m.substring(0,6))&&(u||"1:0:2:"!=m.substring(0,6))?e():initTimerEdit(u,e))}function editTimer(c,l,d){c=decodeURIComponent(c),current_serviceref=c,current_begin=l,current_end=d;var e=!1;void 0!==c&&(e="1:0:2:"==c.substring(0,6)),$("#cbtv").prop("checked",!e),$("#cbradio").prop("checked",e);function t(){timeredit_begindestroy&&(initTimerEditBegin(),timeredit_begindestroy=!1),$.ajax({url:"/api/timerlist",dataType:"json",success:function(e){if(e.result)for(var t in e.timers)if(timer=e.timers[t],timer.serviceref==c&&Math.round(timer.begin)==Math.round(l)&&Math.round(timer.end)==Math.round(d)){$("#timername").val(timer.name),$("#description").val(timer.description),$("#bouquet_select").val(timer.serviceref),$("#bouquet_select").trigger("chosen:updated"),timer.serviceref!==$("#bouquet_select").val()&&($("#bouquet_select").append($("<option></option>").attr("value",timer.serviceref).text(timer.servicename)),$("#bouquet_select").val(timer.serviceref)),$("#dirname").val(timer.dirname),timer.dirname!==$("#dirname").val()&&(current_location="<option value='"+timer.dirname+"'>"+timer.dirname+"</option>",$("#dirname").append(current_location),$("#dirname").val(timer.dirname)),$("#enabled").prop("checked",0==timer.disabled),$("#allow_duplicate").prop("checked",timer.allow_duplicate),$("#autoadjust").prop("checked",timer.autoadjust),$("#justplay").prop("checked",timer.justplay),$("#afterevent").val(timer.afterevent);for(var a=timer.repeated,i=0;i<7;i++)$("#day"+i).prop("checked",1==(1&a)),a>>=1;$("#tagsnew > input").prop("checked",!1);for(var n=timer.tags.split(" "),r=0;r<n.length;r++){var s=n[r].replace(/\(/g,"_").replace(/\)/g,"_").replace(/\'/g,"_");0<s.length&&($("#tag_"+s).length?$("#tag_"+s).prop("checked",!0).checkboxradio("refresh"):$("#tagsnew").append("<input type='checkbox' checked='checked' name='"+s+"' value='"+s+"' id='tag_"+s+"'/><label for='tag_"+s+"'>"+s+"</label>"))}$("#tagsnew > input").checkboxradio({icon:!1}),$("#timerbegin").datetimepicker("setDate",new Date(1e3*Math.round(timer.begin))),$("#timerend").datetimepicker("setDate",new Date(1e3*Math.round(timer.end)));var o=2===timer.state;o?($("#timerbegin").datetimepicker("destroy"),timeredit_begindestroy=!0,$("#timerbegin").addClass("ui-state-disabled"),$("#timername").addClass("ui-state-disabled"),$("#dirname option").not(":selected").attr("disabled","disabled"),$("#bouquet_select option").not(":selected").attr("disabled","disabled")):($("#timername").removeClass("ui-state-disabled"),$("#timerbegin").removeClass("ui-state-disabled"),$("#dirname option").removeAttr("disabled"),$("#bouquet_select option").removeAttr("disabled")),$("#timerbegin").prop("readonly",o),$("#timername").prop("readonly",o),void 0!==timer.vpsplugin_enabled&&(timer.vpsplugin_enabled,0)?(console.debug(timer.vpsplugin_enabled),$("#vpsplugin_enabled").prop("checked",timer.vpsplugin_enabled),$("#vpsplugin_safemode").prop("checked",!timer.vpsplugin_overwrite),$("#has_vpsplugin1").show(),checkVPS()):$("#has_vpsplugin1").hide(),void 0!==timer.always_zap?($("#always_zap1").show(),$("#always_zap").prop("checked",1==timer.always_zap),$("#justplay").prop("disabled",1==timer.always_zap)):$("#always_zap1").hide(),setTimerEditFormTitle(tstr_edit_timer+" - "+timer.name);break}}})}var a;timeredit_initialized?(a=$("#bouquet_select option:last").val(),(!e||"1:0:2:"===a.substring(0,6))&&(e||"1:0:2:"!=a.substring(0,6))?t():initTimerEdit(e,t)):initTimerEdit(e,t)}function changeMoviesort(e){MLHelper.SortMovies(e),MLHelper.ChangeSort(e),MLHelper.ReadMovies(),lastcontenturl="",load_maincontent_spin("ajax/movies")}function changeMoviesortSearch(e){MLHelper.SortMovies(e),MLHelper.ChangeSort(e),MLHelper.ReadMovies(),load_maincontent_spin_force(lastcontenturl)}function initTimerEditForm(){1!==timerFormInitiated&&(timerFormInitiated=1,addTimer(),element=document.getElementById("editTimerForm"),$("#timereditmodal").html(element))}function setTimerEditFormTitle(e){$("#timerEditTitle").html(e)}function toggleMute(){$.ajax("web/vol?set=mute"),getStatusInfo()}function CallEPGResponsive(e){load_tvcontent_spin(e)}function CallEPG(){$("#myepgbtn2").click(function(){$("#tvcontent").load("ajax/multiepg?epgmode=radio")}),$("#myepgbtn3").click(function(){$("#tvcontent").load("ajax/multiepg?epgmode=tv")}),$("#tvbutton").buttonset(),$("#tvcontent").load("ajax/multiepg?epgmode=tv")}function myEPGSearch(){var e=$("#epgSearchTVRadio").val(),t=$("#myepgbtn0").is(":checked")?"&full=1":"",a=$("#myepgbtn1").is(":checked")?"&bouquetsonly=1":"",i="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+a,n=$(window).width()-100,r=$(window).height()-100,a={};a[tstr_close]=function(){$(this).dialog("close")},a[tstr_open_in_new_window]=function(){$(this).dialog("close"),open_epg_search_pop(e,t)},load_dm_spinner(i,tstr_epgsearch,n,r,a)}getStatusInfo=function(){navigator.onLine&&owif.api.getStatusInfo().then(function(e){-1===cur_vol?vol_slider.noUiSlider.set(e.volume):cur_vol!=e.volume&&(cur_vol=-1,vol_slider.noUiSlider.set(e.volume));var t="",t=1==e.muted?(mutestatus=1,"<a href='#' onclick='toggleMute(); return false;'><i class='material-icons'>volume_off</i></a>"):(mutestatus=0,"<a href='#' onclick='toggleMute(); return false;'><i class='material-icons'>volume_up</i></a>");$("#responsive_mute_status").html(t),setOSD(e);var a="",i="";if("true"==e.isRecording){var n,r=e.Recording_list.split("\n"),s=0,o="";for(n in r)""!=r[n]&&(s+=1,o+="<li> <a href='/#timers' onclick='load_maincontent(\"ajax/timers\");' data-dismiss='modal'>"+r[n]+"</a></li><hr />");$("#recmodalcontent").html(o),a="<a href='javascript:void(0);' class='dropdown-toggle' data-toggle='modal' data-target='#RecModal' role='button'><i class='material-icons'>videocam</i><span class='label-count'>"+s+"</span></a>"}if("true"==e.isStreaming){var c,l=e.Streaming_list.split("\n"),d=0,o="";for(c in l)""!=l[c]&&(d+=1,o+="<li>"+l[c]+"</li><hr/>");$("#streammodalcontent").html(o),i="<a href='javascript:void(0);' data-toggle='modal' data-target='#StreamModal' class='dropdown-toggle' role='button'><i class='material-icons'>wifi_tethering</i><span class='label-count'>"+d+"</span></a>"}t="power_settings_new";standby_status="true"==e.inStandby?(t="lightbulb_outline",0!==standby_status&&-1!==standby_status||$(".osd-toggle").hide(),1):(1!==standby_status&&-1!==standby_status||$(".osd-toggle").show(),0);t=" \t\t\t<a href='#' onClick='toggleStandby(); return false'> \t\t\t\t<i class='material-icons'>"+t+"</i> \t\t\t</a>";$("#osd_power_status").html(t),$("#responsive_rec_info").html(a),$("#responsive_stream_info").html(i)})},$.VTiTools={};var $searchBar=$(".search-bar-epg"),$searchBarMovie=$(".search-bar-movie");function gotEPGSearch(){var e=$("#epgsearchtext").val(),t=$("#myepgbtn0").is(":checked")?"&full=1":"",a=$("#myepgbtn1").is(":checked")?"&bouquetsonly=1":"",a="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+a;$("#epgSearch").val(""),load_maincontent(a),lastcontenturl=""}function gotMovieSearch(){var e=$("#moviesearchtext").val(),t=$("#mymoviesearchbtn0").is(":checked")?"&short=1":"",a=$("#mymoviesearchbtn1").is(":checked")?"&extended=1":"",a="ajax/moviesearch?find="+encodeURIComponent(e)+t+a;$("#epgSearch").val(""),load_maincontent_spin_force(a)}function closeMessageModal(){$("#messageSentResponse").html("")}function sendModalMessage(){var e=$("#messageText").val(),t=$("#messageType").val(),a=$("#messageTimeout").val();$.ajax({url:"/api/message?text="+e+"&type="+t+"&timeout="+a,dataType:"json",cache:!1,success:function(e){$("#messageSentResponse").html('<div class="alert alert-info">'+e.message+"</div>"),0==t&&(MessageAnswerCounter=a,setTimeout(countdowngetMessage,1e3))}}),$("#messageText").val(""),$("#messageType").val(1),$("#messageType").selectpicker("refresh"),$("#messageTimeout").val("30"),$("#messageTimeout").removeClass("active"),$("#messageText").addClass("active")}function btn_saveTimer(){var e=moment($("#timerend").val(),"DD.MM.YYYY hh:mm").unix(),t=0;$('[name="repeated"]:checked').each(function(){t+=parseInt($(this).val())});var a="";$('[name="tagsnew"]:checked').each(function(){""!=a&&(a+=" "),a+=$(this).val()});var i={sRef:$("#bouquet_select").val(),end:e,name:$("#timername").val(),description:$("#description").val(),disabled:$("#enabled").is(":checked")?"0":"1",allow_duplicate:$("#allow_duplicate").is(":checked")?"1":"0",autoadjust:$("#autoadjust").is(":checked")?"1":"0",afterevent:$("#afterevent").val(),tags:a,repeated:t};$("#always_zap").is(":checked")?(i.always_zap="1",i.justplay="0"):i.justplay=$("#justplay").is(":checked")?"1":"0","None"!=$("#dirname").val()&&(i.dirname=$("#dirname").val()),$("#has_vpsplugin1").is(":hidden")||(i.vpsplugin_enabled=$("#vpsplugin_enabled").is(":checked")?"1":"0",i.vpsplugin_overwrite=$("#vpsplugin_safemode").is(":checked")?"0":"1"),timeredit_begindestroy?i.begin=Math.round(current_begin):(e=moment($("#timerbegin").val(),"DD.MM.YYYY hh:mm").unix(),i.begin=e);var n=!1;""==current_serviceref?$.ajax({async:!1,dataType:"json",cache:!1,url:"/api/timeradd?",data:i,success:function(e){var t;e.result?n=!0:e.conflicts?(t="Timer Conflicts:<br>",e.conflicts.forEach(function(e){t+=e.name+" / "+e.servicename+" / "+e.realbegin+" - "+e.realend+"<br>"}),showErrorMain(t)):showErrorMain(e.message)}}):(i.channelOld=current_serviceref,i.beginOld=Math.round(current_begin),i.endOld=Math.round(current_end),$.ajax({async:!1,dataType:"json",cache:!1,url:"api/timerchange?",data:i,success:function(e){var t;e.result?n=!0:e.conflicts?(t="Timer Conflicts:<br>",e.conflicts.forEach(function(e){t+=e.name+" / "+e.servicename+" / "+e.realbegin+" - "+e.realend+"<br>"}),$("#error").text(t)):$("#error").text(e.message)}})),n&&reloadTimers&&lastcontenturl.startsWith("ajax/timers")&&(lastcontenturl="",setTimeout(function(){load_maincontent("ajax/timers")},500))}function VTiWebConfig(){$("#mymoviesearchbtn0").change(function(){var e=$("#mymoviesearchbtn0").is(":checked")?"1":"0";$.get("api/setvtiwebconfig?moviesearchshort="+e)}),$("#mymoviesearchbtn1").change(function(){var e=$("#mymoviesearchbtn1").is(":checked")?"1":"0";$.get("api/setvtiwebconfig?moviesearchextended="+e)}),$("#myepgbtn0").change(function(){var e=$("#myepgbtn0").is(":checked")?"1":"0";$.get("api/setvtiwebconfig?fullsearch="+e)}),$("#myepgbtn1").change(function(){var e=$("#myepgbtn1").is(":checked")?"1":"0";$.get("api/setvtiwebconfig?bqonly="+e)}),$("#remotegrabscreen1").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?rcugrabscreen="+e)}),$("#remotecontrolview").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?remotecontrolview="+e),toggleFullRemote()}),$("#minmovielist").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?minmovielist="+e),lastcontenturl.startsWith("ajax/movies")&&load_maincontent_spin_force(lastcontenturl)}),$("#mintimerlist").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?mintimerlist="+e),"ajax/timers"===lastcontenturl&&(lastcontenturl="",load_maincontent("ajax/timers"))}),$("#minepglist").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?minepglist="+e)}),$("#zapstream").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?zapstream="+e)}),$("#showpicons").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?showpicons="+e),$("#showpiconbackground").prop("disabled",!e)}),$("#showpiconbackground").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?showpiconbackground="+e)}),$("#showiptvchannelsinselection").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?showiptvchannelsinselection="+e)}),$("#screenshotchannelname").change(function(){var e=$(this).is(":checked")?"1":"0";$.get("api/setvtiwebconfig?screenshotchannelname="+e)}),$("#thememodebtn").change(function(){var e=$(this).is(":checked")?$(this).val():"supabright";$("body").removeClass(function(e,t){return(t.match(/(^|\s)theme--\S+/g)||[]).join(" ")}),$(this).is(":checked")?$("body").addClass("theme--"+e):$("body").addClass("theme--supabright"),$.get("api/setthememode?themeMode="+e)})}function showErrorMain(e,t){t=void 0!==t?t:"False",""!==e?swal("",e,!0!==t&&"True"!==t&&"true"!==t?"error":"success"):$("#statuscont").hide()}function deleteTimer(t,a,i,e){e=decodeURIComponent(e);swal({title:tstr_del_timer,text:e,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:tstrings_yes_delete,cancelButtonText:tstrings_no_cancel,animation:"none"},function(e){e&&webapi_execute("/api/timerdelete?sRef="+t+"&begin="+a+"&end="+i,function(){$("#"+a+"-"+i).remove()})})}function deleteMovie(t,a,i){swal({title:tstr_del_recording,text:i,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:tstrings_yes_delete,cancelButtonText:tstrings_no_cancel,closeOnConfirm:!1,animation:"none"},function(e){e&&webapi_execute_movie("/api/moviedelete?sRef="+t,function(e){e&&(swal(tstrings_deleted,i,"success"),$("#"+a).remove())})})}function renameMovie(t,a){swal({title:tstr_ren_recording,text:a,type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"none",inputPlaceholder:a,inputValue:a,input:"text"},function(e){return!1!==e&&e!==a&&(""===e?(swal.showInputError(tstrings_need_input),!1):(webapi_execute_movie("/api/movierename?sRef="+t+"&newname="+e),void showErrorMain(e,!0)))})}function closeSideBar(){var e,t=$("body");t.width()<$.AdminBSB.options.leftSideBar.breakpointWidth?(e=$(".navbar .navbar-header .bars"),t.addClass("ls-closed"),e.fadeIn()):t.removeClass("ls-closed")}$.VTiTools.epgsearch={activate:function(){var t=this;$(".js-search-epg").on("click",function(){t.showSearchBar()}),$searchBar.find(".close-search").on("click",function(){t.hideSearchBar()}),$searchBar.find(".start-search").on("click",function(){t.startSearch()}),$searchBar.find('input[type="text"]').on("keyup",function(e){27==e.keyCode?t.hideSearchBar():13==e.keyCode&&t.startSearch()})},showSearchBar:function(){$.VTiTools.moviesearch.hideSearchBarMovie(),$searchBar.addClass("open"),$searchBar.find('input[type="text"]').focus()},hideSearchBar:function(){$searchBar.removeClass("open"),$searchBar.find('input[type="text"]').val("")},startSearch:function(){$("body").hasClass("ls-closed-manual")&&toggleLeftSideBar(),gotEPGSearch(),this.hideSearchBar()}},$.VTiTools.moviesearch={activate:function(){var t=this;$(".js-search-movie").on("click",function(){console.debug("xlkj"),t.showSearchBarMovie()}),$searchBarMovie.find(".close-search").on("click",function(){t.hideSearchBarMovie()}),$searchBarMovie.find(".start-search").on("click",function(){t.startSearchMovie()}),$searchBarMovie.find('input[type="text"]').on("keyup",function(e){27==e.keyCode?t.hideSearchBarMovie():13==e.keyCode&&t.startSearchMovie()})},showSearchBarMovie:function(){$.VTiTools.epgsearch.hideSearchBar(),$searchBarMovie.addClass("open"),$searchBarMovie.find('input[type="text"]').focus()},hideSearchBarMovie:function(){$searchBarMovie.removeClass("open"),$searchBarMovie.find('input[type="text"]').val("")},startSearchMovie:function(){$("body").hasClass("ls-closed-manual")&&toggleLeftSideBar(),gotMovieSearch(),this.hideSearchBarMovie()}};