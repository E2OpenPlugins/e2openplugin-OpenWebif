var autoTimerOptions,tagList=[];function toUnixDate(t){return moment(t,"DD.MM.YY").unix()}function AddFilter(t,e,r){var i=$("#filterlist tbody tr").length.toString();$("#filterlist").append("<tr id='f"+i+"' style='display:none'> \t<td class='nopadding'> \t\t<select class='FT form-control' id='ft"+i+"' > \t\t\t<option value='include'>"+tstr_at_filter_include+"</option> \t\t\t<option value='exclude'>"+tstr_at_filter_exclude+"</option> \t\t</select> \t</td> \t<td class='nopadding'> \t\t<select class='FM form-control' id='fm"+i.toString()+"' > \t\t\t<option value='title' selected=''>"+tstr_at_filter_title+"</option> \t\t\t<option value='shortdescription'>"+tstr_at_filter_short_desc+"</option> \t\t\t<option value='description'>"+tstr_at_filter_desc+"</option> \t\t\t<option value='dayofweek'>"+tstr_at_filter_day+"</option> \t\t\t</select> \t</td> \t<td> \t\t<div class='form-line inactive' id='filine"+i+"'> \t\t\t<input type='text' class='FI form-control' size='20' value='' style='display: block;' id='fi"+i+"'> \t\t</div> \t\t<div id='fsline"+i+"'> \t\t\t<select class='FS' style='display: none;' id='fs"+i+"' > \t\t\t\t<option value='0' selected=''>"+tstr_monday+"</option> \t\t\t\t<option value='1'>"+tstr_tuesday+"</option> \t\t\t\t<option value='2'>"+tstr_wednesday+"</option> \t\t\t\t<option value='3'>"+tstr_thursday+"</option> \t\t\t\t<option value='4'>"+tstr_friday+"</option> \t\t\t\t<option value='5'>"+tstr_saturday+"</option> \t\t\t\t<option value='6'>"+tstr_sunday+"</option> \t\t\t\t<option value='weekend'>"+tstr_weekend+"</option> \t\t\t\t<option value='weekday'>"+tstr_weekday+"</option> \t\t\t</select> \t\t</div> \t</td> \t<td> \t\t<input type='checkbox' class='FR form-control' id='fr"+i+"'> \t\t<label for='fr"+i+"'>"+tstr_at_del+"</label> \t</td> </tr>"),""!=t&&$("#ft"+i).val(t),""!=e&&($("#ft"+i).attr("disabled",!0),$("#fs"+i).attr("disabled",!0),$("#fm"+i).attr("disabled",!0),$("#fi"+i).attr("disabled",!0),"dayofweek"==e?($("#fm"+i).val(e),$("#fi"+i).hide(),$("#filine"+i).hide(),$("#fs"+i).val(r),$("#fs"+i).show()):($("#fm"+i).val(e),$("#fs"+i).hide(),$("#fsline"+i).hide(),$("#fi"+i).val(r),$("#fi"+i).show())),""===t&&""===e&&$.AdminBSB.select.activate(),$("#f"+i).show()}function initValues(){for(var t=$("#maxduration"),e=$("#counter"),r=$("#left"),i=0;i<100;i++){var a=i.toString();i<10&&(a="0"+a),e.append($("<option></option>").val(i).html(a)),r.append($("<option></option>").val(i).html(a))}for(i=0;i<1e3;i++){a=i.toString();i<10&&(a="0"+a),t.append($("<option></option>").val(i).html(a))}$("#tafter").val("5"),$("#tbefore").val("5"),$("#maxduration").val("70"),$("#after").datetimepicker({format:"dd.mm.yy",initialDate:n,autoclose:!0,minView:2}),$("#after").datetimepicker().on("changeDate",function(t){showError(moment($("#before").val(),"DD.MM.YY").unix()<moment($("#after").val(),"DD.MM.YY").unix()?"AFTER:"+tstr_start_after_end:"")});var n=new Date;$("#after").val(moment(n).format("DD.MM.YY"));var s=new Date;s.setDate(n.getDate()+7),$("#from").val("20:15"),$("#to").val("23:15"),$("#aefrom").val("20:15"),$("#aeto").val("23:15"),$("#before").datetimepicker({format:"dd.mm.yy",initialDate:n,autoclose:!0,minView:2}),$("#before").datetimepicker().on("changeDate",function(t){showError(moment($("#before").val(),"DD.MM.YY").unix()<moment($("#after").val(),"DD.MM.YY").unix()?"BEFORE:"+tstr_start_after_end:"")}),$("#before").val(moment(s).format("DD.MM.YY"))}function timeFrameAfterCheck(){if(!0===$("#timeFrameAfter").is(":checked")){var t=moment($("#after").val(),"DD.MM.YY").toDate(),e=new Date(t),r=new Date;r.setDate(e.getDate()+7),t=moment(r).format("DD.MM.YY"),$("#before").val(t),$("#beforeE").show()}else{e=new Date(2038,0,1),t=moment(e).format("DD.MM.YY");$("#before").val(t),$("#beforeE").hide()}}function AutoTimerObj(t){(this.isNew=!1,this.MustSave=!1,this.id=t.attr("id"),this.enabled="yes"==t.attr("enabled"),this.name=t.attr("name"),this.name||(this.name=""),this.match=t.attr("match"),this.match||(this.match=""),this.searchType="partial",t.attr("searchType")&&(this.searchType=t.attr("searchType")),this.searchCase="insensitive",t.attr("searchCase")&&(this.searchCase=t.attr("searchCase")),this.justplay="0",t.attr("justplay")&&(this.justplay=t.attr("justplay")),t.attr("always_zap"))&&("1"==t.attr("always_zap")&&(this.justplay="2"));if(this.overrideAlternatives="1"==t.attr("overrideAlternatives"),this.timeSpan=!1,t.attr("from")&&t.attr("to")&&(this.from=t.attr("from"),this.to=t.attr("to"),this.timeSpan=!0),this.maxduration=null,t.attr("maxduration")&&(this.maxduration=t.attr("maxduration")),t.attr("after")&&t.attr("before")){var e=parseInt(t.attr("after")),r=new Date(1e3*e);this.after=moment(r).format("DD.MM.YY"),e=parseInt(t.attr("before")),r=new Date(1e3*e),this.before=moment(r).format("DD.MM.YY"),this.timeFrame=!0}else this.before=null,this.after=null,this.timeFrame=!1;if(this.avoidDuplicateDescription="0",t.attr("avoidDuplicateDescription")&&(this.avoidDuplicateDescription=t.attr("avoidDuplicateDescription")),this.location=null,t.attr("location")&&(this.location=t.attr("location")),this.timerOffset=!1,t.attr("offset")){var i=t.attr("offset").split(","),a=i[0],n=i[1];this.timerOffsetBefore=(this.timerOffsetAfter=void 0===n?a:n,a),this.timerOffset=!0}var s=t.find("afterevent");this.afterevent=null,s.text()&&(this.afterevent=s.text(),s.attr("from")&&s.attr("to")?(this.aftereventfrom=s.attr("from"),this.aftereventto=s.attr("to")):(this.aftereventfrom=null,this.aftereventto=null));var o=[];a=[];t.find("e2service").each(function(){var t=$(this).find("e2servicereference").text();isBQ(t)?a.push(encodeURIComponent(t)):o.push(t)}),this.Channels=o.slice(),this.Bouquets=a.slice(),a=[],t.find("e2tags").each(function(){var t=$(this).text();a.push(encodeURIComponent(t))}),this.Tags=a.slice();var l=[];t.find("include").each(function(){l.push({t:"include",w:$(this).attr("where"),v:$(this).text()})}),t.find("exclude").each(function(){l.push({t:"exclude",w:$(this).attr("where"),v:$(this).text()})}),this.Filters=l.slice(),this.counter=t.attr("counter"),this.counter||(this.counter="0"),this.left=t.attr("left"),this.left||(this.left="0"),this.counterFormat=t.attr("counterFormat"),this.counterFormat||(this.counterFormat=""),this.vps=!1,this.vpso=!1,"yes"===t.attr("vps_enabled")&&(this.vps=!0,"yes"===t.attr("vps_overwrite")&&(this.vpso=!0)),this.series_labeling=!1,"yes"===t.attr("series_labeling")&&(this.series_labeling=!0),this.autoadjust=!1,"1"===t.attr("autoadjust")&&(this.autoadjust=!0),this.allow_duplicate=!0,"0"===t.attr("allow_duplicate")&&(this.allow_duplicate=!1),this.avoidDuplicateMovies=!1,"1"===t.attr("avoidDuplicateMovies")&&(this.avoidDuplicateMovies=!0)}function saveAT(){if(CurrentAT){var a="/autotimer/edit?";CurrentAT.enabled=$("#enabled").is(":checked"),CurrentAT.name=$("#name").val(),CurrentAT.match=$("#match").val(),CurrentAT.searchType=$("#searchType").val(),CurrentAT.searchCase=$("#searchCase").val(),CurrentAT.justplay=$("#justplay").val(),CurrentAT.overrideAlternatives=$("#overrideAlternatives").is(":checked"),CurrentAT.timeSpan=$("#timeSpan").is(":checked"),CurrentAT.avoidDuplicateDescription=$("#avoidDuplicateDescription").val(),CurrentAT.timeSpan=$("#timeSpan").is(":checked"),CurrentAT.from=$("#from").val(),CurrentAT.to=$("#to").val(),CurrentAT.timerOffset=$("#timerOffset").is(":checked"),CurrentAT.before=$("#before").val(),CurrentAT.after=$("#after").val(),$("#maxDuration").is(":checked")?CurrentAT.maxduration=$("#maxduration").val():CurrentAT.maxduration=null,$("#Location").is(":checked")?CurrentAT.location=$("#location").val():CurrentAT.location=null,CurrentAT.timeFrame=$("#timeFrame").is(":checked"),CurrentAT.timerOffsetBefore=$("#tbefore").val(),CurrentAT.timerOffsetAfter=$("#tafter").val(),CurrentAT.afterevent=$("#afterevent").val(),CurrentAT.aftereventfrom=$("#aefrom").val(),CurrentAT.aftereventto=$("#aeto").val(),CurrentAT.Bouquets=$("#bouquets").val(),CurrentAT.Channels=$("#channels").val();var t=[];for(i=0;i<$("#filterlist tr").length;i++){var e=$("#ft"+i.toString()).val(),r=$("#fm"+i.toString()).val(),n=$("#fi"+i.toString()).val(),s=$("#fs"+i.toString()).val();!1===!!$("#fr"+i.toString()).is(":checked")?"dayofweek"===r?t.push({t:e,w:r,v:s}):t.push({t:e,w:r,v:n}):t.push({t:e,w:r,v:""})}if(CurrentAT.Filters=t.slice(),CurrentAT.Tags=$("#tags").val(),CurrentAT.counter=$("#counter").val(),CurrentAT.left=$("#left").val(),CurrentAT.counterFormat=$("#counterFormat").val(),CurrentAT.vps=$("#vps").is(":checked"),CurrentAT.vpso=!$("#vpssm").is(":checked"),CurrentAT.series_labeling=$("#series_labeling").is(":checked"),CurrentAT.allow_duplicate=$("#allow_duplicate").is(":checked"),CurrentAT.autoadjust=$("#autoadjust").is(":checked"),CurrentAT.avoidDuplicateMovies=$("#avoidDuplicateMovies").is(":checked"),a+="match="+encodeURIComponent(CurrentAT.match),a+="&name="+encodeURIComponent(CurrentAT.name),a+="&enabled=",a+=CurrentAT.enabled?"1":"0","2"==CurrentAT.justplay?a+="&justplay=0&always_zap=1":a+="&justplay="+CurrentAT.justplay,a+="&setEndtime=",a+=CurrentAT.setEndtime?"1":"0",a+="&searchCase="+CurrentAT.searchCase,a+="&overrideAlternatives=",a+=CurrentAT.overrideAlternatives?"1":"0",a+="&avoidDuplicateDescription="+CurrentAT.avoidDuplicateDescription,CurrentAT.location&&(a+="&location="+encodeURIComponent(CurrentAT.location)),a+="&searchType="+CurrentAT.searchType,a+="&maxduration=",CurrentAT.maxduration&&-1<CurrentAT.maxduration&&(a+=CurrentAT.maxduration),"0"!=CurrentAT.counter?(a+="&counter="+CurrentAT.counter,a+="&counterFormat="+CurrentAT.counterFormat):a+="&counter=0",CurrentAT.timerOffset&&-1<CurrentAT.timerOffsetAfter&&-1<CurrentAT.timerOffsetBefore?a+="&offset="+CurrentAT.timerOffsetBefore+","+CurrentAT.timerOffsetAfter:a+="&offset=",CurrentAT.timeSpan?a+="&timespanFrom="+CurrentAT.from+"&timespanTo="+CurrentAT.to:a+="&timespanFrom=&timespanTo=",CurrentAT.timeFrame?a+="&before="+toUnixDate(CurrentAT.before)+"&after="+toUnixDate(CurrentAT.after):a+="&before=&after=",CurrentAT.Tags&&0<CurrentAT.Tags.length?$.each(CurrentAT.Tags,function(t,e){a+="&tag="+e}):a+="&tag=",a+="&services=",CurrentAT.Channels&&0<CurrentAT.Channels.length){var o=[];$.each(CurrentAT.Channels,function(t,e){o.push(encodeURIComponent(e))}),a+=o.join(",")}a+="&bouquets=",CurrentAT.Bouquets&&0<CurrentAT.Bouquets.length&&(a+=CurrentAT.Bouquets.join(",")),CurrentAT.Filters&&0<CurrentAT.Filters.length&&$.each(CurrentAT.Filters,function(t,e){var r="&";"exclude"===e.t&&(r+="!"),r+=e.w,r+="=","dayofweek"===e.w?r+=e.v:r+=encodeURIComponent(e.v),a+=r}),a+="&autoadjust=",a+=CurrentAT.autoadjust?"1":"0",a+="&allow_duplicate=",a+=CurrentAT.allow_duplicate?"1":"0",a+="&avoidDuplicateMovies=",a+=CurrentAT.avoidDuplicateMovies?"1":"0",CurrentAT.vps||(CurrentAT.vpo=!1),a+="&vps_enabled=",a+=CurrentAT.vps?"1":"0",a+="&vps_overwrite=",a+=CurrentAT.vpso?"1":"0",a+="&series_labeling=",a+=CurrentAT.series_labeling?"1":"0";var l=CurrentAT.afterevent;""==l?l="default":"none"==l?l="nothing":"shutdown"==l&&(l="deepstandby"),a+="&afterevent="+l,"default"!==l&&(a+="&aftereventFrom="+CurrentAT.aftereventfrom,a+="&aftereventTo="+CurrentAT.aftereventto),CurrentAT.isNew||(a+="&id="+CurrentAT.id),$.ajax({type:"GET",url:a,dataType:"xml",success:function(t){var e=$(t).find("e2state").first();showError($(t).find("e2statetext").first().text(),e.text()),readAT($("#atlist").val())},error:function(t,e,r){showError(t.responseText)}}),$("#filterlist").empty()}}function checkValues(){if(!0===$("#timeSpan").is(":checked")?$("#timeSpanE").show():$("#timeSpanE").hide(),!0===$("#timeSpanAE").is(":checked")?$("#timeSpanAEE").show():$("#timeSpanAEE").hide(),!0===$("#timeFrame").is(":checked")?($("#timeFrameE").show(),$("#timeFrameAfterCheckBox").show()):($("#timeFrameE").hide(),$("#timeFrameAfterCheckBox").hide()),!0===$("#timerOffset").is(":checked")?$("#timerOffsetE").show():$("#timerOffsetE").hide(),!0===$("#maxDuration").is(":checked")?$("#maxDurationE").show():$("#maxDurationE").hide(),!0===$("#Location").is(":checked")?$("#LocationE").show():$("#LocationE").hide(),!0===$("#Bouquets").is(":checked"))$("#BouquetsE").show();else{$("#BouquetsE").hide();try{bouquetChoices.removeActiveItems()}catch(t){}}if(!0===$("#Channels").is(":checked"))$("#ChannelsE").show();else{$("#ChannelsE").hide();try{channelChoices.removeActiveItems()}catch(t){}}if(!0===$("#Tags").is(":checked"))$("#TagsE").show();else{$("#TagsE").hide();try{tagChoices.removeActiveItems()}catch(t){}}!0===$("#Filter").is(":checked")?$(".FilterE").show():$(".FilterE").hide(),""!=$("#afterevent").val()?$("#AftereventE").show():$("#AftereventE").hide(),"0"!=$("#counter").val()?$("#CounterE").show():$("#CounterE").hide(),!0===$("#vps").is(":checked")?$("#vpsE").show():$("#vpsE").hide()}function getAutoTimerSettings(){$.ajax({type:"GET",url:"/autotimer/get",dataType:"xml",success:function(t){$(t).find("e2setting").each(function(){var t=$(this).find("e2settingname").text(),e=$(this).find("e2settingvalue").text();0===t.indexOf("config.plugins.autotimer.")&&(t=t.substring(25),"True"===e?$("#ats_"+t).prop("checked",!0):"False"===e?$("#ats_"+t).prop("checked",!1):$("#ats_"+t).val(e))})},error:function(t,e,r){showError(t.responseText)}})}function test_simulateAT(t){$("#simtb").append("<tr><td COLSPAN=6>"+loadspinner+"</td></tr>");var e=t?"simulate":"test",r=t?"e2simulatedtimer":"e2testtimer";"test"!==e||CurrentAT.isNew?(e="simulate",r="e2simulatedtimer"):e+="?id="+CurrentAT.id,console.debug("LINK",e,r),$.ajax({type:"GET",url:"/autotimer/"+e,dataType:"xml",success:function(t){console.debug(t);var o=[];$(t).find(r).each(function(){var t="<tr>";t+="<td>"+$(this).find("e2state").text()+"</td>",t+="<td>"+$(this).find("e2autotimername").text()+"</td>",t+="<td>"+$(this).find("e2name").text()+"</td>",t+="<td>"+$(this).find("e2servicename").text()+"</td>";var e=$(this).find("e2timebegin").text(),r=new Date(1e3*Math.round(e)),i=r.getHours(),a=r.getMinutes(),n=(9<i?"":"0")+i.toString(),s=(9<a?"":"0")+a.toString();t+="<td>"+(e=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()+" "+n+":"+s)+"</td>",e=$(this).find("e2timeend").text(),i=(r=new Date(1e3*Math.round(e))).getHours(),a=r.getMinutes();n=(9<i?"":"0")+i.toString(),s=(9<a?"":"0")+a.toString();t+="<td>"+(e=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()+" "+n+":"+s)+"</td>",t+="</tr>",console.debug(t),o.push(t)}),$("#simtb").empty(),$(o).each(function(t,e){$("#simtb").append(e)}),0===o.length&&$("#simtb").append("<tr><td COLSPAN=6>NO Timer found</td></tr>")},error:function(t,e,r){showError(t.responseText)}})}function InitPage(){$("#timeSpan").click(function(){checkValues()}),$("#timeSpanAE").click(function(){checkValues()}),$("#timeFrame").click(function(){checkValues()}),$("#timeFrameAfter").click(function(){timeFrameAfterCheck()}),$("#timerOffset").click(function(){checkValues()}),$("#maxDuration").click(function(){checkValues()}),$("#Location").click(function(){checkValues()}),$("#Bouquets").click(function(){checkValues()}),$("#Channels").click(function(){checkValues()}),$("#Filter").click(function(){checkValues()}),$("#Tags").click(function(){checkValues()}),$("#AddFilter").click(function(){AddFilter("","","")}),$("#afterevent").change(function(){checkValues()}),$("#counter").change(function(){checkValues()}),$("#vps").change(function(){checkValues()}),initValues(),checkValues(),reloadAT(),autoTimerOptions=owif.gui.populateAutoTimerOptions(),$(".FM").change(function(){var t=$(this).parent().parent();"dayofweek"==$(this).val()?(t.find(".FS").show(),t.find(".FI").hide()):(t.find(".FS").hide(),t.find(".FI").show())})}function delAT(){CurrentAT&&!CurrentAT.isNew&&swal({title:tstr_del_autotimer+" ?",text:CurrentAT.name,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:tstrings_yes_delete+" !",cancelButtonText:tstrings_no_cancel+" !",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?$.ajax({type:"GET",url:"/autotimer/remove?id="+CurrentAT.id,dataType:"xml",success:function(t){var e=$(t).find("e2state").first();showError($(t).find("e2statetext").first().text(),e.text()),readAT()},error:function(t,e,r){showError(t.responseText)}}):swal(tstrings_cancelled,CurrentAT.name,"error")})}function addAT(t){if(CurrentAT&&CurrentAT.isNew)showError("please save the current autotimer first");else{var e=1;$(atxml).find("timer").each(function(){var t=parseInt($(this).attr("id"));e<=t&&(e=t+1)});var r=tstr_timernewname,i=e.toString(),a='<timers><timer name="'+r+'" match="'+r+'" enabled="yes" id="'+i+'" justplay="0" overrideAlternatives="1"></timer></timers>';void 0!==t&&(a='<timers><timer name="'+t.name+'" match="'+t.name+'" enabled="yes" id="'+i+'" from="'+t.from+'" to="'+t.to+'"',a+=' searchType="exact" searchCase="sensitive" justplay="0" overrideAlternatives="1" ',a+="><e2service><e2servicereference>"+t.sref+"</e2servicereference><e2servicename>"+t.sname+"</e2servicename></e2service>",a+="</timer></timers>");var n=$.parseXML(a);$(n).find("timer").each(function(){$("#atlist").append($("<option data-id='"+$(this).attr("id")+"' value='"+$(this).attr("id")+"' data-x-selected >"+$(this).attr("name")+"</option>")).selectpicker("refresh"),CurrentAT=new AutoTimerObj($(this)),CurrentAT.isNew=!0,CurrentAT.MustSave=!0,CurrentAT.UpdateUI()}),$("#atlist").find("li").each(function(){$(this).data("id")==i?$(this).addClass("ui-selected"):$(this).removeClass("ui-selected")})}}function readAT(e){CurrentAT=null,$.ajax({type:"GET",url:"/autotimer",dataType:"xml",success:function(t){atxml=t,Parse(e)},error:function(t,e,r){showError(t.responseText)}})}function Parse(e){e=void 0!==e?e:-1,$("#atlist").empty(),$("#filterlist").empty();var t=[];tagList=[],"false"==$(atxml).find("e2state").first().text()&&showError($(atxml).find("e2statetext").first().text()),$(atxml).find("timer").each(function(){t.push($(this)),$(this).find("e2tags").each(function(){var t=$(this).text();tagList.indexOf(t)<0&&tagList.push(t)})}),t.sort(function(t,e){var r=t.attr("name"),i=e.attr("name");return r==i?0:i<r?1:-1});var r="<option selected disabled>Select an AutoTimer</option>";if($(t).each(function(){var t="";(e||"").toString()===$(this).attr("id").toString()&&(t="selected"),r+="<option data-id='"+$(this).attr("id")+"' value='"+$(this).attr("id")+"' "+t+" >"+$(this).attr("name")+"</option>"}),$("#atlist").html(r).selectpicker("refresh"),at2add)addAT(at2add),at2add=null;else{var i=$("#atlist").val();i?FillAT(i):addAT()}0<t.length?($("#atbutton5").show(),$("#atbutton6").show()):($("#atbutton5").hide(),$("#atbutton6").hide())}function showError(t,e){var r="error";!0!==(e=void 0!==e?e:"False")&&"True"!==e&&"true"!==e||(r="success"),""!==t?swal("",t,r):$("#statuscont").hide()}AutoTimerObj.prototype.UpdateUI=function(){($("#filterlist").empty(),$("#enabled").prop("checked",this.enabled),$("#name").val(this.name),$("#match").val(this.match),$("#searchType").val(this.searchType).selectpicker("refresh"),$("#searchCase").val(this.searchCase).selectpicker("refresh"),$("#justplay").val(this.justplay),$("#overrideAlternatives").prop("checked",this.overrideAlternatives),$("#timeSpan").prop("checked",this.timeSpan),$("#at_name").html("("+this.name+")"),this.timeSpan&&($("#from").val(this.from),$("#to").val(this.to)),this.maxduration?($("#maxDuration").prop("checked",!0),$("#maxduration").val(this.maxduration)):$("#maxDuration").prop("checked",!1),$("#timeFrame").prop("checked",this.timeFrame),this.timeFrame)&&($("#after").val(this.after),$("#before").val(this.before),moment($("#before").val(),"DD.MM.YY").toDate()<new Date(2038,0,1)?($("#timeFrameAfter").prop("checked",!0),$("#beforeE").show()):($("#timeFrameAfter").prop("checked",!1),$("#beforeE").hide()));$("#avoidDuplicateDescription").val(this.avoidDuplicateDescription).selectpicker("refresh"),this.location?($("#location").val(this.location),this.location!==$("#location").val()&&(current_location="<option value='"+this.location+"'>"+this.location+"</option>",$("#location").append(current_location),$("#location").val(this.location)),$("#location").selectpicker("refresh"),$("#Location").prop("checked",!0)):$("#Location").prop("checked",!1),$("#timerOffset").prop("checked",this.timerOffset),this.timerOffset&&($("#tafter").val(this.timerOffsetAfter),$("#tbefore").val(this.timerOffsetBefore)),$("#timeSpanAE").prop("checked",!1),$("#afterevent").val(""),this.afterevent&&($("#afterevent").val(this.afterevent),this.aftereventfrom&&this.aftereventto&&($("#aefrom").val(this.aftereventfrom),$("#aeto").val(this.aftereventto),$("#timeSpanAE").prop("checked",!0))),$("#afterevent").selectpicker("refresh");var t=[];try{(t=tagList.map(function(t){return{value:t,label:t}})).push(this.Tags)}catch(t){console.debug("Failed to process tag options")}autoTimerOptions.tags.highlightAll().removeHighlightedItems().setChoices(t,"value","label",!1).setChoiceByValue(this.Tags);var e=this.Channels.map(function(t){return{value:t,label:t}});autoTimerOptions.channels.highlightAll().removeHighlightedItems().setChoices(e,"value","label",!1).setChoiceByValue(this.Channels);e=this.Channels.map(function(t){return{value:t,label:t}});var r=this.Bouquets.map(function(t){return{value:t,label:t}});autoTimerOptions.bouquets.highlightAll().removeHighlightedItems().setChoices(r,"value","label",!1).setChoiceByValue(this.Bouquets),$("#Tags").prop("checked",0<this.Tags.length),$("#Channels").prop("checked",0<this.Channels.length),$("#Bouquets").prop("checked",0<this.Bouquets.length);var i=$("#filterlist tr").length;if(1<i)for(var a=1;a<i;a++)$("#f"+a.toString()).remove();var n=0;$.each(this.Filters,function(t,e){n++,AddFilter(e.t,e.w,e.v)}),$.AdminBSB.select.activate(),$("#Filter").prop("checked",0<n),$("#counter").val(this.counter),$("#left").val(this.left),$("#counterFormat").val(this.counterFormat),$("#vps").prop("checked",this.vps),$("#vpssm").prop("checked",!this.vpso),$("#series_labeling").prop("checked",this.series_labeling),$("#autoadjust").prop("checked",this.autoadjust),$("#allow_duplicate").prop("checked",this.allow_duplicate),$("#avoidDuplicateMovies").prop("checked",this.avoidDuplicateMovies),checkValues()};